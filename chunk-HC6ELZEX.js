import{a as B}from"./chunk-XPOHC24I.js";import"./chunk-VSKOGBAH.js";import"./chunk-ADY2GKJC.js";import"./chunk-WBLWCSP5.js";import"./chunk-UXMDVUQN.js";import"./chunk-HC6MZPB3.js";import"./chunk-YMI2B6JE.js";import"./chunk-4YKVRCH4.js";import"./chunk-FERD25SW.js";import"./chunk-SYQESB6R.js";import"./chunk-LEIMCQKJ.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-4JAX2GF5.js";import"./chunk-MCRJI3T3.js";import"./chunk-YUQCATHU.js";import"./chunk-WZBJ6353.js";import{b as j}from"./chunk-2SKO46GI.js";import{$a as T,A as m,Aa as P,B as t,Ba as D,C as e,D as h,Da as M,I as C,Q as a,R as f,Va as O,Y as b,Z as y,_a as G,aa as I,ab as V,bb as A,da as F,ea as _,eb as K,fb as k,gb as z,ib as R,jb as $,ra as p,s as l,sa as E,t as d,ta as x,v,va as N,wa as q,xa as w,y as g}from"./chunk-VG5HJCEH.js";import"./chunk-N3PT3BRI.js";import"./chunk-5TFNS7IN.js";import"./chunk-QKUHOLOF.js";import"./chunk-6DP5AXAB.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-QXT6YJJ4.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as S}from"./chunk-RW4GY4BD.js";function L(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let c=o.$implicit;m("value",c),l(),f(c)}}function H(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let c=o.$implicit;m("value",c.key),l(),f(c.key)}}function Z(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let c=o.$implicit;m("value",c),l(),f(c)}}var ie=(()=>{let o=class o{constructor(i,n,s){var u;this.fb=i,this.sheetsService=n,this.alertController=s,this.categories={},this.months=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],this.catRange="Cat!A1:Z",this.speseForm=this.fb.group({descrizione:["",p.required],mese:[this.getCurrentMonth(),p.required],giorno:[this.getCurrentDay(),[p.required,p.min(1),p.max(31)]],spesa:["",[p.required,p.pattern("^[0-9]+(\\.[0-9]{1,2})?$")]],categoriaPrimaria:["",p.required],categoriaSecondaria:["",p.required]}),(u=this.speseForm.get("categoriaPrimaria"))==null||u.valueChanges.subscribe(()=>{this.speseForm.patchValue({categoriaSecondaria:""})}),this.loadCategories()}getCurrentMonth(){let i=new Date().getMonth();return this.months[i]}getCurrentDay(){return new Date().getDate()}loadCategories(){return S(this,null,function*(){try{this.categories=yield this.sheetsService.getCategories(this.catRange)}catch{yield(yield this.alertController.create({header:"Errore",message:"Impossibile caricare le categorie.",buttons:["OK"]})).present()}})}getSecondaryCategories(){var n;let i=(n=this.speseForm.get("categoriaPrimaria"))==null?void 0:n.value;return this.categories[i]||[]}submitSpesa(){return S(this,null,function*(){if(this.speseForm.invalid){yield(yield this.alertController.create({header:"Errore",message:"Per favore, compila tutti i campi correttamente.",buttons:["OK"]})).present();return}let i=this.speseForm.value,n=[i.descrizione,i.mese,i.giorno,i.spesa,i.categoriaPrimaria,i.categoriaSecondaria];try{yield this.sheetsService.appendData("Spese!A2:F",n),yield(yield this.alertController.create({header:"Successo",message:"Spesa inserita correttamente.",buttons:["OK"]})).present(),this.speseForm.reset({mese:this.getCurrentMonth(),giorno:this.getCurrentDay()})}catch{yield(yield this.alertController.create({header:"Errore",message:"C'\xE8 stato un problema nell'inserimento della spesa.",buttons:["OK"]})).present()}})}};o.\u0275fac=function(n){return new(n||o)(d(D),d(j),d(B))},o.\u0275cmp=v({type:o,selectors:[["app-inserisci-spese"]],decls:36,vars:8,consts:[[1,"ion-padding",3,"fullscreen"],[3,"ngSubmit","formGroup"],["position","stacked"],["formControlName","descrizione","type","text","required",""],["formControlName","mese","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","giorno","type","number","min","1","max","31","required",""],["formControlName","spesa","type","number","min","0","step","0.01","required",""],["formControlName","categoriaPrimaria","required",""],["formControlName","categoriaSecondaria","required",""],["expand","full","type","submit",3,"disabled"],[3,"value"]],template:function(n,s){n&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),a(3,"Inserisci Spesa"),e()()(),t(4,"ion-content",0)(5,"form",1),C("ngSubmit",function(){return s.submitSpesa()}),t(6,"ion-item")(7,"ion-label",2),a(8,"Descrizione"),e(),h(9,"ion-input",3),e(),t(10,"ion-item")(11,"ion-label",2),a(12,"Mese"),e(),t(13,"ion-select",4),g(14,L,2,2,"ion-select-option",5),e()(),t(15,"ion-item")(16,"ion-label",2),a(17,"Giorno"),e(),h(18,"ion-input",6),e(),t(19,"ion-item")(20,"ion-label",2),a(21,"Spesa (\u20AC)"),e(),h(22,"ion-input",7),e(),t(23,"ion-item")(24,"ion-label",2),a(25,"Categoria Primaria"),e(),t(26,"ion-select",8),g(27,H,2,2,"ion-select-option",5),b(28,"keyvalue"),e()(),t(29,"ion-item")(30,"ion-label",2),a(31,"Categoria Secondaria"),e(),t(32,"ion-select",9),g(33,Z,2,2,"ion-select-option",5),e()(),t(34,"ion-button",10),a(35,"Inserisci"),e()()()),n&2&&(l(4),m("fullscreen",!0),l(),m("formGroup",s.speseForm),l(9),m("ngForOf",s.months),l(13),m("ngForOf",y(28,6,s.categories)),l(6),m("ngForOf",s.getSecondaryCategories()),l(),m("disabled",s.speseForm.invalid))},dependencies:[O,$,R,K,A,V,G,T,z,k,_,I,F,M,N,E,x,P,q,w],encapsulation:2});let r=o;return r})();export{ie as InserisciSpesePage};
