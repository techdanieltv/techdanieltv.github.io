import{A as Q,a as V,b as O,c as A,d as G,i as T,j as K,k,l as z,m as R,q as $,r as j,s as B,t as L,v as H,w as Z,x as J}from"./chunk-QGA5YZV3.js";import"./chunk-SIDZIVJD.js";import"./chunk-5UZQIQ7A.js";import"./chunk-3SXNPFQ7.js";import"./chunk-4PGTP63H.js";import"./chunk-ODTSDC7S.js";import"./chunk-HC6MZPB3.js";import"./chunk-IE6PXRL6.js";import"./chunk-FERD25SW.js";import"./chunk-SYQESB6R.js";import"./chunk-LEIMCQKJ.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-7YR6A2SD.js";import"./chunk-MCRJI3T3.js";import"./chunk-JNW6QASV.js";import"./chunk-XI2YEWEB.js";import{b as U}from"./chunk-3KAX6AFY.js";import{C as g,F as m,G as t,H as e,I as h,N as C,Oa as c,Pa as E,Qa as x,Sa as N,Ta as M,Ua as q,V as a,W as f,Xa as w,Ya as P,_a as D,ba as b,ca as y,ga as I,ja as F,ka as _,v as l,w as d,y as v}from"./chunk-6OY3HDAQ.js";import"./chunk-2VTV7JYR.js";import"./chunk-7ZOQVXVY.js";import"./chunk-ZBVVLYRZ.js";import"./chunk-F7XBNY6P.js";import"./chunk-MQFCGRNH.js";import"./chunk-3M36IMRS.js";import"./chunk-HE2NRPEE.js";import"./chunk-LTIPSBNC.js";import"./chunk-JWIEPCRG.js";import"./chunk-LF5XB4YN.js";import{f as S}from"./chunk-RW4GY4BD.js";function W(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let p=o.$implicit;m("value",p),l(),f(p)}}function X(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let p=o.$implicit;m("value",p.key),l(),f(p.key)}}function Y(r,o){if(r&1&&(t(0,"ion-select-option",11),a(1),e()),r&2){let p=o.$implicit;m("value",p),l(),f(p)}}var le=(()=>{let o=class o{constructor(i,n,s){var u;this.fb=i,this.sheetsService=n,this.alertController=s,this.categories={},this.months=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],this.catRange="Cat!A1:Z",this.speseForm=this.fb.group({descrizione:["",c.required],mese:[this.getCurrentMonth(),c.required],giorno:[this.getCurrentDay(),[c.required,c.min(1),c.max(31)]],spesa:["",[c.required,c.pattern("^[0-9]+(\\.[0-9]{1,2})?$")]],categoriaPrimaria:["",c.required],categoriaSecondaria:["",c.required]}),(u=this.speseForm.get("categoriaPrimaria"))==null||u.valueChanges.subscribe(()=>{this.speseForm.patchValue({categoriaSecondaria:""})}),this.loadCategories()}getCurrentMonth(){let i=new Date().getMonth();return this.months[i]}getCurrentDay(){return new Date().getDate()}loadCategories(){return S(this,null,function*(){try{this.categories=yield this.sheetsService.getCategories(this.catRange)}catch{yield(yield this.alertController.create({header:"Errore",message:"Impossibile caricare le categorie.",buttons:["OK"]})).present()}})}getSecondaryCategories(){var n;let i=(n=this.speseForm.get("categoriaPrimaria"))==null?void 0:n.value;return this.categories[i]||[]}submitSpesa(){return S(this,null,function*(){if(this.speseForm.invalid){yield(yield this.alertController.create({header:"Errore",message:"Per favore, compila tutti i campi correttamente.",buttons:["OK"]})).present();return}let i=this.speseForm.value,n=[i.descrizione,i.mese,i.giorno,i.spesa,i.categoriaPrimaria,i.categoriaSecondaria];try{yield this.sheetsService.appendData("Spese!A2:F",n),yield(yield this.alertController.create({header:"Successo",message:"Spesa inserita correttamente.",buttons:["OK"]})).present(),this.speseForm.reset({mese:this.getCurrentMonth(),giorno:this.getCurrentDay()})}catch{yield(yield this.alertController.create({header:"Errore",message:"C'\xE8 stato un problema nell'inserimento della spesa.",buttons:["OK"]})).present()}})}};o.\u0275fac=function(n){return new(n||o)(d(P),d(U),d(J))},o.\u0275cmp=v({type:o,selectors:[["app-inserisci-spese"]],decls:36,vars:8,consts:[[1,"ion-padding",3,"fullscreen"],[3,"ngSubmit","formGroup"],["position","stacked"],["formControlName","descrizione","type","text","required",""],["formControlName","mese","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","giorno","type","number","min","1","max","31","required",""],["formControlName","spesa","type","number","min","0","step","0.01","required",""],["formControlName","categoriaPrimaria","required",""],["formControlName","categoriaSecondaria","required",""],["expand","full","type","submit",3,"disabled"],[3,"value"]],template:function(n,s){n&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),a(3,"Inserisci Spesa"),e()()(),t(4,"ion-content",0)(5,"form",1),C("ngSubmit",function(){return s.submitSpesa()}),t(6,"ion-item")(7,"ion-label",2),a(8,"Descrizione"),e(),h(9,"ion-input",3),e(),t(10,"ion-item")(11,"ion-label",2),a(12,"Mese"),e(),t(13,"ion-select",4),g(14,W,2,2,"ion-select-option",5),e()(),t(15,"ion-item")(16,"ion-label",2),a(17,"Giorno"),e(),h(18,"ion-input",6),e(),t(19,"ion-item")(20,"ion-label",2),a(21,"Spesa (\u20AC)"),e(),h(22,"ion-input",7),e(),t(23,"ion-item")(24,"ion-label",2),a(25,"Categoria Primaria"),e(),t(26,"ion-select",8),g(27,X,2,2,"ion-select-option",5),b(28,"keyvalue"),e()(),t(29,"ion-item")(30,"ion-label",2),a(31,"Categoria Secondaria"),e(),t(32,"ion-select",9),g(33,Y,2,2,"ion-select-option",5),e()(),t(34,"ion-button",10),a(35,"Inserisci"),e()()()),n&2&&(l(4),m("fullscreen",!0),l(),m("formGroup",s.speseForm),l(9),m("ngForOf",s.months),l(13),m("ngForOf",y(28,6,s.categories)),l(6),m("ngForOf",s.getSecondaryCategories()),l(),m("disabled",s.speseForm.invalid))},dependencies:[Q,G,T,K,k,z,R,$,j,B,L,V,O,A,Z,H,_,I,F,D,N,E,x,w,M,q],encapsulation:2});let r=o;return r})();export{le as InserisciSpesePage};
